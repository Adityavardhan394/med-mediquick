<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MediQuick - Professional Cart</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary: #10b981;
      --primary-dark: #059669;
      --primary-light: #d1fae5;
      --primary-ultra-light: #f0fdf4;
      --accent: #3b82f6;
      --accent-light: #dbeafe;
      --success: #059669;
      --warning: #f59e0b;
      --error: #ef4444;
      --text-primary: #1f2937;
      --text-secondary: #4b5563;
      --text-muted: #6b7280;
      --bg-primary: #ffffff;
      --bg-secondary: #f9fafb;
      --bg-gradient: linear-gradient(135deg, #ffffff 0%, #f9fafb 50%, #f3f4f6 100%);
      --border-light: #d1d5db;
      --border-green: #a7f3d0;
      --shadow-soft: 0 4px 20px rgba(0, 0, 0, 0.08);
      --shadow-medium: 0 8px 30px rgba(0, 0, 0, 0.12);
      --shadow-strong: 0 15px 40px rgba(0, 0, 0, 0.15);
    }

    * {
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', sans-serif;
      background: var(--bg-gradient);
      min-height: 100vh;
      color: var(--text-primary);
      overflow-x: hidden;
    }

    /* Light Background Pattern */
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: 
        radial-gradient(circle at 25% 25%, rgba(16, 185, 129, 0.02) 0%, transparent 50%),
        radial-gradient(circle at 75% 75%, rgba(59, 130, 246, 0.015) 0%, transparent 50%),
        linear-gradient(45deg, transparent 49%, rgba(16, 185, 129, 0.008) 50%, transparent 51%);
      background-size: 400px 400px, 600px 600px, 100px 100px;
      animation: backgroundFloat 20s ease-in-out infinite alternate;
      z-index: -1;
    }

    @keyframes backgroundFloat {
      0% { 
        transform: translateX(0px) translateY(0px) rotate(0deg);
        opacity: 1;
      }
      100% { 
        transform: translateX(30px) translateY(-30px) rotate(1deg);
        opacity: 0.8;
      }
    }

    /* Light Glass Effect */
    .glass-effect {
      background: rgba(255, 255, 255, 0.98);
      backdrop-filter: blur(10px) saturate(150%);
      border: 1px solid rgba(255, 255, 255, 0.8);
      box-shadow: var(--shadow-soft);
    }

    .glass-effect-strong {
      background: rgba(255, 255, 255, 0.99);
      backdrop-filter: blur(15px) saturate(180%);
      border: 1px solid var(--border-light);
      box-shadow: var(--shadow-medium);
    }

    /* Light Animations */
    @keyframes slideInUp {
      from {
        opacity: 0;
        transform: translateY(30px) scale(0.98);
      }
      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    @keyframes fadeInScale {
      from {
        opacity: 0;
        transform: scale(0.95);
      }
      to {
        opacity: 1;
        transform: scale(1);
      }
    }

    @keyframes pulseGreen {
      0%, 100% {
        box-shadow: 0 0 20px rgba(16, 185, 129, 0.2);
        transform: scale(1);
      }
      50% {
        box-shadow: 0 0 30px rgba(16, 185, 129, 0.3);
        transform: scale(1.01);
      }
    }

    @keyframes shimmer {
      0% {
        background-position: -200% 0;
      }
      100% {
        background-position: 200% 0;
      }
    }

    .animate-slide-up {
      animation: slideInUp 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }

    .animate-fade-scale {
      animation: fadeInScale 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }

    .glow-effect {
      animation: pulseGreen 2s infinite;
    }

    .shimmer-effect {
      background: linear-gradient(90deg, transparent, rgba(16, 185, 129, 0.05), transparent);
      background-size: 200% 100%;
      animation: shimmer 2s infinite;
    }

    /* Light Header Design */
    .header-gradient {
      background: linear-gradient(135deg, #10b981 0%, #059669 100%);
      position: relative;
      overflow: hidden;
    }

    .header-gradient::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.1) 50%, transparent 70%);
      transform: translateX(-100%);
      animation: headerShine 3s infinite;
    }

    @keyframes headerShine {
      0% { transform: translateX(-100%); }
      50% { transform: translateX(100%); }
      100% { transform: translateX(100%); }
    }

    /* Light Card Design */
    .modern-card {
      background: var(--bg-primary);
      border-radius: 20px;
      box-shadow: var(--shadow-soft);
      border: 1px solid var(--border-light);
      transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      position: relative;
      overflow: hidden;
    }

    .modern-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, var(--primary), var(--accent), var(--primary));
      background-size: 200% 100%;
      animation: gradientShift 3s ease-in-out infinite;
    }

    @keyframes gradientShift {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }

    .modern-card:hover {
      box-shadow: var(--shadow-medium);
      transform: translateY(-4px) scale(1.005);
      border-color: var(--border-green);
    }

    /* Light Progress Steps */
    .progress-step {
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
      flex: 1;
    }

    .progress-step::before {
      content: '';
      position: absolute;
      top: 25px;
      left: 50%;
      width: 100%;
      height: 2px;
      background: var(--border-light);
      z-index: 1;
      border-radius: 1px;
    }

    .progress-step:last-child::before {
      display: none;
    }

    .progress-step.active::before {
      background: var(--primary);
      animation: progressFlow 1s ease-in-out;
    }

    @keyframes progressFlow {
      0% { width: 0%; }
      100% { width: 100%; }
    }

    .step-circle {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background: var(--bg-primary);
      border: 2px solid var(--border-light);
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      z-index: 2;
      transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
    }

    .progress-step.active .step-circle {
      background: var(--primary);
      border-color: var(--primary);
      color: white;
      box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
      transform: scale(1.05);
    }

    .progress-step.completed .step-circle {
      background: var(--success);
      border-color: var(--success);
      color: white;
      box-shadow: 0 3px 12px rgba(5, 150, 105, 0.25);
    }

    /* Light Payment Options */
    .payment-option {
      background: var(--bg-primary);
      border: 2px solid var(--border-light);
      border-radius: 16px;
      padding: 20px;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      position: relative;
      overflow: hidden;
    }

    .payment-option::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(16, 185, 129, 0.05), transparent);
      transition: left 0.5s ease;
    }

    .payment-option:hover::before {
      left: 100%;
    }

    .payment-option:hover {
      border-color: var(--primary);
      transform: translateY(-2px) scale(1.01);
      box-shadow: var(--shadow-medium);
      background: var(--primary-ultra-light);
    }

    .payment-option.selected {
      border-color: var(--primary);
      background: var(--primary-light);
      box-shadow: var(--shadow-medium);
      transform: scale(1.02);
    }

    .payment-option.selected::after {
      content: '✓';
      position: absolute;
      top: -8px;
      right: -8px;
      background: var(--primary);
      color: white;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      font-weight: bold;
      box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);
    }

    /* Light UPI Grid */
    .upi-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 16px;
      margin-top: 20px;
    }

    .upi-app {
      background: var(--bg-primary);
      border: 2px solid var(--border-light);
      border-radius: 16px;
      padding: 16px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      position: relative;
      overflow: hidden;
    }

    .upi-app::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(45deg, transparent 49%, rgba(255, 255, 255, 0.5) 50%, transparent 51%);
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .upi-app:hover::before {
      opacity: 1;
    }

    .upi-app:hover {
      border-color: var(--primary);
      transform: translateY(-3px) scale(1.03);
      box-shadow: var(--shadow-medium);
    }

    .upi-app.selected {
      border-color: var(--primary);
      background: var(--primary-light);
      box-shadow: var(--shadow-medium);
      transform: scale(1.05);
    }

    .upi-app.selected::after {
      content: '✓';
      position: absolute;
      top: -6px;
      right: -6px;
      background: var(--primary);
      color: white;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 10px;
      font-weight: bold;
      box-shadow: 0 2px 6px rgba(16, 185, 129, 0.3);
    }

    .upi-logo {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      margin: 0 auto 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      color: white;
      position: relative;
      overflow: hidden;
      box-shadow: 0 3px 12px rgba(0, 0, 0, 0.12);
      transition: transform 0.3s ease;
    }

    .upi-app:hover .upi-logo {
      transform: rotateY(15deg);
    }

    /* UPI App Colors - Lighter versions */
    .gpay { background: linear-gradient(135deg, #4285f4, #34a853); }
    .phonepe { background: linear-gradient(135deg, #5f2eea, #8e2de2); }
    .paytm { background: linear-gradient(135deg, #00bcd4, #0097a7); }
    .amazon { background: linear-gradient(135deg, #ff9900, #ff6600); }
    .bhim { background: linear-gradient(135deg, #ff6b35, #f7931e); }
    .whatsapp { background: linear-gradient(135deg, #25d366, #128c7e); }

    /* Light Buttons */
    .btn-primary {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      color: white;
      border: none;
      border-radius: 12px;
      padding: 16px 32px;
      font-weight: 600;
      font-size: 16px;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      position: relative;
      overflow: hidden;
      box-shadow: var(--shadow-soft);
    }

    .btn-primary::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.5s ease;
    }

    .btn-primary:hover::before {
      left: 100%;
    }

    .btn-primary:hover {
      transform: translateY(-2px) scale(1.01);
      box-shadow: var(--shadow-medium);
      background: linear-gradient(135deg, var(--primary-dark) 0%, var(--success) 100%);
    }

    .btn-primary:active {
      transform: translateY(0) scale(1);
    }

    /* Light Input Design */
    .modern-input {
      background: var(--bg-primary);
      border: 2px solid var(--border-light);
      border-radius: 12px;
      padding: 16px 18px;
      font-size: 16px;
      transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      width: 100%;
      box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.05);
      color: var(--text-primary);
    }

    .modern-input:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px var(--primary-light), inset 0 1px 3px rgba(16, 185, 129, 0.1);
      background: var(--bg-primary);
    }

    .modern-input::placeholder {
      color: var(--text-muted);
      transition: color 0.3s ease;
    }

    .modern-input:focus::placeholder {
      color: var(--primary);
    }

    /* Light Cart Items */
    .cart-item {
      background: var(--bg-primary);
      border-radius: 16px;
      padding: 24px;
      margin-bottom: 16px;
      box-shadow: var(--shadow-soft);
      border: 1px solid var(--border-light);
      transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      position: relative;
      overflow: hidden;
    }

    .cart-item::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 3px;
      height: 100%;
      background: var(--primary);
      transition: width 0.3s ease;
    }

    .cart-item:hover {
      box-shadow: var(--shadow-medium);
      transform: translateY(-2px) scale(1.005);
      border-color: var(--border-green);
    }

    .cart-item:hover::before {
      width: 5px;
    }

    .medicine-icon-container {
      width: 80px;
      height: 80px;
      border-radius: 16px;
      background: var(--primary-light);
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 20px;
      box-shadow: 0 3px 12px rgba(16, 185, 129, 0.15);
      transition: transform 0.3s ease;
    }

    .cart-item:hover .medicine-icon-container {
      transform: rotate(3deg) scale(1.02);
    }

    .quantity-control {
      background: var(--bg-secondary);
      border-radius: 12px;
      padding: 8px;
      display: flex;
      align-items: center;
      gap: 12px;
      box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.05);
    }

    .quantity-btn {
      width: 36px;
      height: 36px;
      border-radius: 8px;
      border: none;
      background: var(--primary);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      box-shadow: 0 2px 6px rgba(16, 185, 129, 0.25);
    }

    .quantity-btn:hover {
      background: var(--primary-dark);
      transform: scale(1.05);
      box-shadow: 0 3px 8px rgba(16, 185, 129, 0.3);
    }

    /* Light Status Indicators */
    .status-indicator {
      padding: 6px 12px;
      border-radius: 16px;
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      box-shadow: 0 1px 4px rgba(0, 0, 0, 0.08);
    }

    .status-prescription {
      background: #fef3c7;
      color: #92400e;
      border: 1px solid #f3e8c7;
    }

    .status-verified {
      background: var(--primary-light);
      color: var(--success);
      border: 1px solid var(--border-green);
    }

    /* Light Loading States */
    .loading-spinner {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 2px solid var(--primary-light);
      border-top: 2px solid var(--primary);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Light Toast Notifications */
    .toast {
      position: fixed;
      bottom: 24px;
      right: 24px;
      background: var(--bg-primary);
      color: var(--text-primary);
      padding: 16px 24px;
      border-radius: 12px;
      box-shadow: var(--shadow-medium);
      z-index: 1000;
      transform: translateX(120%);
      transition: transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      border: 1px solid var(--border-light);
    }

    .toast.show {
      transform: translateX(0);
    }

    .toast.success {
      border-left: 4px solid var(--success);
      background: #f0fdf4;
      color: #166534;
    }

    .toast.error {
      border-left: 4px solid var(--error);
      background: #fef2f2;
      color: #991b1b;
    }

    .toast.info {
      border-left: 4px solid var(--accent);
      background: #eff6ff;
      color: #1e40af;
    }

    /* Better Text Visibility */
    h1, h2, h3, h4, h5, h6 {
      color: var(--text-primary);
      font-weight: 600;
    }

    p {
      color: var(--text-secondary);
    }

    .text-gray-800 {
      color: var(--text-primary) !important;
    }

    .text-gray-600 {
      color: var(--text-secondary) !important;
    }

    .text-gray-500 {
      color: var(--text-muted) !important;
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .upi-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 12px;
      }
      
      .modern-card {
        margin: 12px;
        border-radius: 16px;
      }
      
      .cart-item {
        padding: 16px;
      }
      
      .medicine-icon-container {
        width: 64px;
        height: 64px;
        margin-right: 16px;
      }

      .step-circle {
        width: 42px;
        height: 42px;
      }
    }

    /* Light Floating Elements */
    .floating-elements {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: -1;
    }

    .floating-pill {
      position: absolute;
      width: 30px;
      height: 30px;
      background: rgba(16, 185, 129, 0.05);
      border-radius: 50%;
      animation: float 25s infinite linear;
    }

    @keyframes float {
      0% {
        transform: translateY(100vh) rotateZ(0deg);
        opacity: 0;
      }
      10% {
        opacity: 0.3;
      }
      90% {
        opacity: 0.3;
      }
      100% {
        transform: translateY(-100px) rotateZ(360deg);
        opacity: 0;
      }
    }
  </style>
</head>
<body>
  <!-- Professional Header -->
  <header class="header-gradient shadow-2xl">
    <div class="container mx-auto px-6 py-4">
      <div class="flex items-center justify-between">
        <button onclick="window.location.href='medicines.html'" 
                class="flex items-center space-x-3 text-white hover:bg-white/10 px-4 py-2 rounded-xl transition-all duration-300">
          <i class="material-icons">arrow_back</i>
          <span class="font-semibold">Back to Store</span>
        </button>
        <div class="text-center">
          <h1 class="text-3xl font-bold text-white">Professional Checkout</h1>
          <p class="text-white/80 text-sm">Secure & Fast Payment Experience</p>
        </div>
        <div class="w-32"></div>
      </div>
    </div>
  </header>

  <!-- Floating Design Elements -->
  <div class="floating-elements">
    <div class="floating-pill" style="left: 10%; animation-delay: 0s;"></div>
    <div class="floating-pill" style="left: 20%; animation-delay: 5s;"></div>
    <div class="floating-pill" style="left: 30%; animation-delay: 10s;"></div>
    <div class="floating-pill" style="left: 40%; animation-delay: 15s;"></div>
    <div class="floating-pill" style="left: 50%; animation-delay: 3s;"></div>
    <div class="floating-pill" style="left: 60%; animation-delay: 8s;"></div>
    <div class="floating-pill" style="left: 70%; animation-delay: 13s;"></div>
    <div class="floating-pill" style="left: 80%; animation-delay: 18s;"></div>
    <div class="floating-pill" style="left: 90%; animation-delay: 7s;"></div>
  </div>

  <!-- Main Content -->
  <div class="container mx-auto px-6 py-8">
    <!-- Professional Progress Steps -->
    <div class="modern-card mb-8 p-8 animate-fade-scale">
      <div class="flex justify-between items-center mb-6">
        <div class="progress-step active completed" id="step1">
          <div class="step-circle">
            <i class="material-icons">shopping_cart</i>
          </div>
          <span class="mt-3 text-sm font-semibold">Cart Review</span>
        </div>
        <div class="progress-step" id="step2">
          <div class="step-circle">
            <i class="material-icons">location_on</i>
          </div>
          <span class="mt-3 text-sm font-semibold">Delivery</span>
        </div>
        <div class="progress-step" id="step3">
          <div class="step-circle">
            <i class="material-icons">payment</i>
          </div>
          <span class="mt-3 text-sm font-semibold">Payment</span>
        </div>
        <div class="progress-step" id="step4">
          <div class="step-circle">
            <i class="material-icons">check_circle</i>
          </div>
          <span class="mt-3 text-sm font-semibold">Complete</span>
        </div>
      </div>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
      <!-- Cart Items Section -->
      <div class="lg:col-span-2 space-y-6">
        <!-- Cart Items -->
        <div class="modern-card p-6 animate-slide-up" id="cartSection">
          <div class="flex items-center justify-between mb-6">
            <h2 class="text-2xl font-bold text-gray-800">Your Cart Items</h2>
            <div class="bg-primary/10 text-primary px-3 py-1 rounded-full text-sm font-semibold" id="itemCount">
              0 items
            </div>
          </div>
          <div id="cartItemsContainer">
            <!-- Cart items will be loaded here -->
          </div>
        </div>

        <!-- Delivery Address Section -->
        <div class="modern-card p-6 hidden animate-slide-up" id="addressSection">
          <div class="flex items-center justify-between mb-6">
            <h2 class="text-2xl font-bold text-gray-800">Delivery Address</h2>
            <button onclick="showAddAddressModal()" 
                    class="text-primary hover:text-primary-dark font-semibold flex items-center gap-2">
              <i class="material-icons text-sm">add</i>
              Add New Address
            </button>
          </div>
          <div id="addressList" class="space-y-4">
            <!-- Addresses will be loaded here -->
          </div>
        </div>

        <!-- Payment Method Section -->
        <div class="modern-card p-6 hidden animate-slide-up" id="paymentSection">
          <h2 class="text-2xl font-bold text-gray-800 mb-6">Payment Method</h2>
          
          <!-- Payment Options -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
            <div class="payment-option selected" data-method="card">
              <div class="flex items-center gap-4">
                <div class="w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center">
                  <i class="fas fa-credit-card text-blue-600 text-lg"></i>
                </div>
                <div>
                  <h3 class="font-semibold text-gray-800">Credit/Debit Card</h3>
                  <p class="text-sm text-gray-500">Visa, Mastercard, RuPay</p>
                </div>
              </div>
            </div>
            
            <div class="payment-option" data-method="upi">
              <div class="flex items-center gap-4">
                <div class="w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center">
                  <i class="fas fa-mobile-alt text-green-600 text-lg"></i>
                </div>
                <div>
                  <h3 class="font-semibold text-gray-800">UPI Payment</h3>
                  <p class="text-sm text-gray-500">Pay using UPI apps</p>
                </div>
              </div>
            </div>
          </div>

          <!-- Card Payment Form -->
          <div id="cardPaymentForm" class="space-y-4">
            <div class="grid grid-cols-1 gap-4">
              <input type="text" placeholder="Card Number" class="modern-input" id="cardNumber" maxlength="19">
              <input type="text" placeholder="Cardholder Name" class="modern-input" id="cardName">
              <div class="grid grid-cols-2 gap-4">
                <input type="text" placeholder="MM/YY" class="modern-input" id="cardExpiry" maxlength="5">
                <input type="password" placeholder="CVV" class="modern-input" id="cardCvv" maxlength="3">
              </div>
            </div>
          </div>

          <!-- UPI Payment Form -->
          <div id="upiPaymentForm" class="hidden space-y-6">
            <div>
              <input type="text" placeholder="Enter UPI ID (Optional)" class="modern-input" id="upiId">
              <p class="text-sm text-gray-500 mt-2">Or select your preferred UPI app below</p>
            </div>
            
            <div class="upi-grid">
              <div class="upi-app" data-app="gpay">
                <div class="upi-logo gpay">G</div>
                <span class="font-semibold text-sm">Google Pay</span>
              </div>
              <div class="upi-app" data-app="phonepe">
                <div class="upi-logo phonepe">Pe</div>
                <span class="font-semibold text-sm">PhonePe</span>
              </div>
              <div class="upi-app" data-app="paytm">
                <div class="upi-logo paytm">Pt</div>
                <span class="font-semibold text-sm">Paytm</span>
              </div>
              <div class="upi-app" data-app="amazon">
                <div class="upi-logo amazon">A</div>
                <span class="font-semibold text-sm">Amazon Pay</span>
              </div>
              <div class="upi-app" data-app="bhim">
                <div class="upi-logo bhim">B</div>
                <span class="font-semibold text-sm">BHIM</span>
              </div>
              <div class="upi-app" data-app="whatsapp">
                <div class="upi-logo whatsapp">
                  <i class="fab fa-whatsapp"></i>
                </div>
                <span class="font-semibold text-sm">WhatsApp</span>
              </div>
            </div>
            
            <div id="upiStatus" class="hidden p-4 rounded-xl">
              <!-- UPI payment status will be shown here -->
            </div>
          </div>
        </div>
      </div>

      <!-- Order Summary -->
      <div class="lg:col-span-1">
        <div class="modern-card p-6 sticky top-4 animate-fade-scale">
          <h2 class="text-xl font-bold text-gray-800 mb-6">Order Summary</h2>
          
          <!-- Coupon Section -->
          <div class="mb-6">
            <div class="flex gap-2">
              <input type="text" placeholder="Coupon Code" class="modern-input flex-grow" id="couponInput">
              <button class="btn-primary px-4" onclick="applyCoupon()">Apply</button>
            </div>
          </div>
          
          <!-- Price Breakdown -->
          <div class="space-y-4 mb-6">
            <div class="flex justify-between text-gray-600">
              <span>Subtotal</span>
              <span id="subtotal">₹0.00</span>
            </div>
            <div class="flex justify-between text-gray-600">
              <span>Delivery Fee</span>
              <span id="deliveryFee">₹0.00</span>
            </div>
            <div class="flex justify-between text-gray-600">
              <span>Tax (GST)</span>
              <span id="tax">₹0.00</span>
            </div>
            <div class="flex justify-between text-green-600">
              <span>Discount</span>
              <span id="discount">-₹0.00</span>
            </div>
            <hr class="border-gray-200">
            <div class="flex justify-between text-xl font-bold text-gray-800">
              <span>Total</span>
              <span id="totalAmount">₹0.00</span>
            </div>
          </div>

          <button id="proceedBtn" onclick="proceedToNext()" 
                  class="btn-primary w-full glow-effect">
            <span id="btnText">Proceed to Address</span>
            <i class="material-icons ml-2">arrow_forward</i>
          </button>

          <div class="mt-4 text-center">
            <a href="medicines.html" class="text-primary hover:text-primary-dark font-semibold flex items-center justify-center gap-2">
              <i class="material-icons text-sm">arrow_back</i>
              Continue Shopping
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    class ProfessionalCart {
      constructor() {
        this.cart = JSON.parse(localStorage.getItem('cartItems')) || [];
        this.currentStep = 1;
        this.selectedPaymentMethod = 'card';
        this.selectedUPIApp = null;
        this.addresses = JSON.parse(localStorage.getItem('addresses')) || [];
        this.couponApplied = null;
        
        this.init();
      }

      init() {
        this.createDefaultAddress();
        this.loadCart();
        this.setupEventListeners();
        this.updateSummary();
      }

      createDefaultAddress() {
        if (this.addresses.length === 0) {
          this.addresses.push({
            id: Date.now(),
            fullName: 'Test User',
            mobile: '9876543210',
            addressLine1: 'Plot No. 123, Near Medical Store',
            addressLine2: 'Dammaiguda Main Road',
            city: 'Hyderabad',
            pincode: '500083',
            state: 'Telangana',
            isDefault: true
          });
          localStorage.setItem('addresses', JSON.stringify(this.addresses));
        }
      }

      setupEventListeners() {
        // Payment method selection
        document.querySelectorAll('.payment-option').forEach(option => {
          option.addEventListener('click', () => {
            document.querySelectorAll('.payment-option').forEach(o => o.classList.remove('selected'));
            option.classList.add('selected');
            this.selectedPaymentMethod = option.dataset.method;
            this.togglePaymentForm();
          });
        });

        // UPI app selection
        document.querySelectorAll('.upi-app').forEach(app => {
          app.addEventListener('click', () => {
            document.querySelectorAll('.upi-app').forEach(a => a.classList.remove('selected'));
            app.classList.add('selected');
            this.selectedUPIApp = app.dataset.app;
          });
        });

        // Card number formatting
        document.getElementById('cardNumber').addEventListener('input', this.formatCardNumber);
        document.getElementById('cardExpiry').addEventListener('input', this.formatExpiry);
        document.getElementById('cardCvv').addEventListener('input', this.formatCVV);
      }

      togglePaymentForm() {
        const cardForm = document.getElementById('cardPaymentForm');
        const upiForm = document.getElementById('upiPaymentForm');
        
        if (this.selectedPaymentMethod === 'card') {
          cardForm.classList.remove('hidden');
          upiForm.classList.add('hidden');
        } else {
          cardForm.classList.add('hidden');
          upiForm.classList.remove('hidden');
        }
      }

      formatCardNumber(e) {
        let value = e.target.value.replace(/\D/g, '');
        let formattedValue = value.replace(/(\d{4})(?=\d)/g, '$1 ');
        e.target.value = formattedValue;
      }

      formatExpiry(e) {
        let value = e.target.value.replace(/\D/g, '');
        if (value.length >= 2) {
          value = value.slice(0, 2) + '/' + value.slice(2, 4);
        }
        e.target.value = value;
      }

      formatCVV(e) {
        e.target.value = e.target.value.replace(/\D/g, '').slice(0, 3);
      }

      loadCart() {
        const container = document.getElementById('cartItemsContainer');
        const itemCount = document.getElementById('itemCount');
        
        if (this.cart.length === 0) {
          container.innerHTML = `
            <div class="text-center py-12">
              <div class="w-24 h-24 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center">
                <i class="material-icons text-4xl text-gray-400">shopping_cart</i>
              </div>
              <h3 class="text-xl font-semibold text-gray-700 mb-2">Your cart is empty</h3>
              <p class="text-gray-500 mb-6">Add some medicines to get started</p>
              <a href="medicines.html" class="btn-primary inline-flex items-center gap-2">
                <i class="material-icons">arrow_back</i>
                Browse Medicines
              </a>
            </div>
          `;
          itemCount.textContent = '0 items';
          return;
        }

        itemCount.textContent = `${this.cart.length} item${this.cart.length > 1 ? 's' : ''}`;
        
        container.innerHTML = this.cart.map((item, index) => {
          // Handle both data formats - medicines.html and cart.html
          const name = item.name;
          const price = item.priceValue || parseFloat(item.price?.replace('₹', '') || 0);
          const quantity = item.quantity || 1;
          const icon = item.icon || 'fas fa-pills';
          const category = item.category || 'Medicine';
          const brandName = item.brandName || item.manufacturer || 'Generic';
          
          return `
            <div class="cart-item">
              <div class="flex items-center gap-4">
                <div class="medicine-icon-container">
                  <i class="${icon} text-3xl text-primary"></i>
                </div>
                
                <div class="flex-grow">
                  <h3 class="text-lg font-semibold text-gray-800 mb-1">${name}</h3>
                  <div class="flex items-center gap-2 mb-2">
                    <span class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full">${category}</span>
                    <span class="text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded-full">${brandName}</span>
                    ${item.prescription ? `
                      <span class="status-indicator status-prescription">
                        <i class="fas fa-prescription-bottle-alt mr-1"></i>Prescription Required
                      </span>
                    ` : ''}
                    ${item.prescriptionVerified ? `
                      <span class="status-indicator status-verified">
                        <i class="fas fa-check-circle mr-1"></i>Verified
                      </span>
                    ` : ''}
                  </div>
                  <p class="text-sm text-gray-600">₹${price.toFixed(2)} per unit</p>
                </div>

                <div class="flex items-center gap-4">
                  <div class="quantity-control">
                    <button class="quantity-btn" onclick="cart.updateQuantity(${index}, -1)">
                      <i class="material-icons text-sm">remove</i>
                    </button>
                    <span class="font-semibold min-w-[2rem] text-center">${quantity}</span>
                    <button class="quantity-btn" onclick="cart.updateQuantity(${index}, 1)">
                      <i class="material-icons text-sm">add</i>
                    </button>
                  </div>

                  <div class="text-right">
                    <div class="text-lg font-bold text-primary">₹${(price * quantity).toFixed(2)}</div>
                    <button onclick="cart.removeItem(${index})" 
                            class="text-red-500 hover:text-red-700 mt-1">
                      <i class="material-icons">delete</i>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          `;
        }).join('');
      }

      updateQuantity(index, change) {
        const item = this.cart[index];
        item.quantity = Math.max(1, (item.quantity || 1) + change);
        this.saveCart();
        this.loadCart();
        this.updateSummary();
        this.showToast(`Updated ${item.name} quantity`, 'success');
      }

      removeItem(index) {
        const item = this.cart[index];
        this.cart.splice(index, 1);
        this.saveCart();
        this.loadCart();
        this.updateSummary();
        this.showToast(`Removed ${item.name} from cart`, 'success');
      }

      updateSummary() {
        const subtotal = this.cart.reduce((sum, item) => {
          const price = item.priceValue || parseFloat(item.price?.replace('₹', '') || 0);
          return sum + (price * (item.quantity || 1));
        }, 0);
        const deliveryFee = this.cart.length > 0 ? 40 : 0;
        const tax = subtotal * 0.18; // 18% GST
        const discount = this.couponApplied ? this.calculateDiscount(subtotal) : 0;
        const total = subtotal + deliveryFee + tax - discount;

        document.getElementById('subtotal').textContent = `₹${subtotal.toFixed(2)}`;
        document.getElementById('deliveryFee').textContent = `₹${deliveryFee.toFixed(2)}`;
        document.getElementById('tax').textContent = `₹${tax.toFixed(2)}`;
        document.getElementById('discount').textContent = `-₹${discount.toFixed(2)}`;
        document.getElementById('totalAmount').textContent = `₹${total.toFixed(2)}`;
      }

      calculateDiscount(subtotal) {
        if (!this.couponApplied) return 0;
        switch(this.couponApplied) {
          case 'FIRST20': return subtotal * 0.2;
          case 'MEDI100': return Math.min(100, subtotal * 0.1);
          case 'SAVE50': return 50;
          default: return 0;
        }
      }

      saveCart() {
        localStorage.setItem('cartItems', JSON.stringify(this.cart));
      }

      showToast(message, type = 'success') {
        const toast = document.createElement('div');
        let bgColor, icon;
        
        switch(type) {
          case 'error':
            bgColor = 'bg-red-500';
            icon = 'error';
            break;
          case 'info':
            bgColor = 'bg-blue-500';
            icon = 'info';
            break;
          case 'warning':
            bgColor = 'bg-yellow-500';
            icon = 'warning';
            break;
          default:
            bgColor = 'bg-green-500';
            icon = 'check_circle';
        }
        
        toast.className = `fixed bottom-6 right-6 ${bgColor} text-white px-6 py-3 rounded-lg shadow-lg transition-all transform translate-y-0 opacity-100 z-50`;
        toast.innerHTML = `
          <div class="flex items-center gap-2">
            <i class="material-icons text-sm">${icon}</i>
            <span>${message}</span>
          </div>
        `;
        document.body.appendChild(toast);

        // Auto remove after delay
        const delay = type === 'error' ? 5000 : type === 'info' ? 3000 : 3000;
        setTimeout(() => {
          toast.style.transform = 'translateY(20px)';
          toast.style.opacity = '0';
          setTimeout(() => toast.remove(), 300);
        }, delay);
      }

      async processPayment() {
        const btn = document.getElementById('proceedBtn');
        const btnText = document.getElementById('btnText');
        
        btn.disabled = true;
        btnText.innerHTML = '<span class="loading-spinner mr-2"></span>Processing Payment...';

        try {
          if (this.selectedPaymentMethod === 'upi') {
            await this.processUPIPayment();
          } else {
            await this.processCardPayment();
          }
        } catch (error) {
          this.showToast(error.message, 'error');
          btn.disabled = false;
          btnText.textContent = 'Place Order';
        }
      }

      async processUPIPayment() {
        // Show UPI processing status
        const upiStatus = document.getElementById('upiStatus');
        upiStatus.className = 'block p-4 rounded-xl bg-blue-50 border border-blue-200';
        upiStatus.innerHTML = `
          <div class="flex items-center gap-3">
            <span class="loading-spinner"></span>
            <div>
              <p class="font-semibold text-blue-800">Processing UPI Payment...</p>
              <p class="text-sm text-blue-600">Please complete payment in your UPI app</p>
            </div>
          </div>
        `;

        // Simulate payment processing
        await new Promise(resolve => setTimeout(resolve, 3000));

        // Success
        upiStatus.className = 'block p-4 rounded-xl bg-green-50 border border-green-200';
        upiStatus.innerHTML = `
          <div class="flex items-center gap-3">
            <i class="material-icons text-green-600">check_circle</i>
            <div>
              <p class="font-semibold text-green-800">Payment Successful!</p>
              <p class="text-sm text-green-600">Transaction ID: UPI${Date.now()}</p>
            </div>
          </div>
        `;

        await this.completeOrder();
      }

      async processCardPayment() {
        // Simulate card processing
        await new Promise(resolve => setTimeout(resolve, 2000));
        await this.completeOrder();
      }

      async completeOrder() {
        // Save order for tracking
        const orderData = {
          orderId: `MQ${Date.now()}`,
          items: this.cart,
          total: document.getElementById('totalAmount').textContent,
          paymentMethod: this.selectedPaymentMethod.toUpperCase(),
          upiApp: this.selectedUPIApp,
          orderDate: new Date().toISOString(),
          status: 'confirmed',
          address: this.addresses.find(addr => addr.isDefault),
          estimatedDelivery: new Date(Date.now() + 30 * 60 * 1000).toISOString()
        };

        localStorage.setItem('currentOrder', JSON.stringify(orderData));
        
        // Clear cart
        this.cart = [];
        this.saveCart();
        
        this.showToast('Order placed successfully! Redirecting...', 'success');
        
        setTimeout(() => {
          window.location.href = 'orders.html';
        }, 2000);
      }
    }

    // Global functions
    function proceedToNext() {
      if (cart.currentStep === 1) {
        cart.currentStep = 2;
        document.getElementById('step2').classList.add('active');
        document.getElementById('addressSection').classList.remove('hidden');
        document.getElementById('btnText').textContent = 'Proceed to Payment';
      } else if (cart.currentStep === 2) {
        cart.currentStep = 3;
        document.getElementById('step3').classList.add('active');
        document.getElementById('paymentSection').classList.remove('hidden');
        document.getElementById('btnText').textContent = 'Place Order';
      } else {
        cart.processPayment();
      }
    }

    function applyCoupon() {
      const input = document.getElementById('couponInput');
      const code = input.value.trim().toUpperCase();
      
      const validCoupons = ['FIRST20', 'MEDI100', 'SAVE50'];
      
      if (validCoupons.includes(code)) {
        cart.couponApplied = code;
        cart.updateSummary();
        cart.showToast(`Coupon ${code} applied successfully!`, 'success');
        input.value = '';
      } else {
        cart.showToast('Invalid coupon code', 'error');
      }
    }

    function showAddAddressModal() {
      const modal = document.createElement('div');
      modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 opacity-0 transition-opacity duration-300';
      modal.id = 'addressModal';
      
      modal.innerHTML = `
        <div class="bg-white rounded-2xl p-8 w-full max-w-md mx-4 transform scale-95 transition-transform duration-300">
          <div class="flex justify-between items-center mb-6">
            <h3 class="text-2xl font-bold text-gray-800">Add New Address</h3>
            <button onclick="closeAddressModal()" class="text-gray-500 hover:text-gray-700">
              <i class="material-icons">close</i>
            </button>
          </div>
          
          <form id="addressForm" class="space-y-4">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <input type="text" placeholder="Full Name" class="modern-input" id="newFullName" required>
              <input type="tel" placeholder="Mobile Number" class="modern-input" id="newMobile" required maxlength="10">
            </div>
            
            <input type="text" placeholder="Address Line 1 (House/Flat/Office)" class="modern-input" id="newAddressLine1" required>
            <input type="text" placeholder="Address Line 2 (Area/Landmark)" class="modern-input" id="newAddressLine2">
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
              <input type="text" placeholder="City" class="modern-input" id="newCity" required>
              <input type="text" placeholder="State" class="modern-input" id="newState" required>
              <input type="text" placeholder="Pincode" class="modern-input" id="newPincode" required maxlength="6">
            </div>
            
            <div class="flex items-center gap-2">
              <input type="checkbox" id="setAsDefault" class="w-4 h-4 text-primary">
              <label for="setAsDefault" class="text-sm text-gray-600">Set as default address</label>
            </div>
            
            <div class="flex justify-end gap-4 mt-8">
              <button type="button" onclick="closeAddressModal()" 
                      class="px-6 py-3 text-gray-600 hover:bg-gray-100 rounded-lg transition-all">
                Cancel
              </button>
              <button type="submit" 
                      class="btn-primary">
                <i class="material-icons mr-2">add_location</i>
                Add Address
              </button>
            </div>
          </form>
        </div>
      `;
      
      document.body.appendChild(modal);
      
      // Trigger animation
      setTimeout(() => {
        modal.classList.remove('opacity-0');
        modal.querySelector('.bg-white').classList.remove('scale-95');
        modal.querySelector('.bg-white').classList.add('scale-100');
      }, 10);
      
      // Setup form submission
      document.getElementById('addressForm').addEventListener('submit', handleAddressSubmit);
    }

    function closeAddressModal() {
      const modal = document.getElementById('addressModal');
      if (modal) {
        modal.classList.add('opacity-0');
        modal.querySelector('.bg-white').classList.remove('scale-100');
        modal.querySelector('.bg-white').classList.add('scale-95');
        
        setTimeout(() => {
          modal.remove();
        }, 300);
      }
    }

    function handleAddressSubmit(e) {
      e.preventDefault();
      
      const newAddress = {
        id: Date.now(),
        fullName: document.getElementById('newFullName').value.trim(),
        mobile: document.getElementById('newMobile').value.trim(),
        addressLine1: document.getElementById('newAddressLine1').value.trim(),
        addressLine2: document.getElementById('newAddressLine2').value.trim(),
        city: document.getElementById('newCity').value.trim(),
        state: document.getElementById('newState').value.trim(),
        pincode: document.getElementById('newPincode').value.trim(),
        isDefault: document.getElementById('setAsDefault').checked
      };
      
      // Validate required fields
      if (!newAddress.fullName || !newAddress.mobile || !newAddress.addressLine1 || 
          !newAddress.city || !newAddress.state || !newAddress.pincode) {
        cart.showToast('Please fill in all required fields', 'error');
        return;
      }
      
      // Validate mobile number
      if (!/^\d{10}$/.test(newAddress.mobile)) {
        cart.showToast('Please enter a valid 10-digit mobile number', 'error');
        return;
      }
      
      // Validate pincode
      if (!/^\d{6}$/.test(newAddress.pincode)) {
        cart.showToast('Please enter a valid 6-digit pincode', 'error');
        return;
      }
      
      // If setting as default, unset other defaults
      if (newAddress.isDefault) {
        cart.addresses.forEach(addr => addr.isDefault = false);
      }
      
      // Add to addresses array
      cart.addresses.push(newAddress);
      localStorage.setItem('addresses', JSON.stringify(cart.addresses));
      
      // Refresh address display
      cart.displayAddresses();
      
      // Close modal and show success
      closeAddressModal();
      cart.showToast(`Address added successfully for ${newAddress.fullName}`, 'success');
    }

    // Initialize cart
    const cart = new ProfessionalCart();

    // Add demo items if cart is empty (for testing)
    if (cart.cart.length === 0) {
      const demoItems = [
        {
          name: 'Paracetamol 500mg',
          priceValue: 25.50,
          quantity: 2,
          icon: 'fas fa-pills',
          prescription: false,
          manufacturer: 'Cipla Ltd',
          category: 'Pain Relief'
        },
        {
          name: 'Amoxicillin 250mg',
          priceValue: 89.00,
          quantity: 1,
          icon: 'fas fa-capsules',
          prescription: true,
          prescriptionVerified: true,
          manufacturer: 'Sun Pharma',
          category: 'Antibiotics'
        },
        {
          name: 'Vitamin D3 Tablets',
          priceValue: 150.00,
          quantity: 1,
          icon: 'fas fa-tablets',
          prescription: false,
          manufacturer: 'Abbott',
          category: 'Vitamins'
        }
      ];
      
      cart.cart = demoItems;
      cart.saveCart();
      cart.loadCart();
      cart.updateSummary();
    }

    // Debug: Log cart initialization
    console.log('Cart initialized with', cart.cart.length, 'items:', cart.cart);
    
    // Force refresh cart display to ensure it loads properly
    setTimeout(() => {
      cart.loadCart();
      cart.updateSummary();
      console.log('Cart refreshed after initialization');
    }, 100);

    // Listen for storage changes to update cart when items are added from other pages
    window.addEventListener('storage', function(e) {
      if (e.key === 'cartItems') {
        cart.cart = JSON.parse(e.newValue) || [];
        cart.loadCart();
        cart.updateSummary();
      }
    });

    // Listen for page focus/visibility to refresh cart
    window.addEventListener('focus', function() {
      const currentCart = JSON.parse(localStorage.getItem('cartItems')) || [];
      if (JSON.stringify(currentCart) !== JSON.stringify(cart.cart)) {
        cart.cart = currentCart;
        cart.loadCart();
        cart.updateSummary();
        console.log('Cart updated on page focus');
      }
    });

    document.addEventListener('visibilitychange', function() {
      if (!document.hidden) {
        const currentCart = JSON.parse(localStorage.getItem('cartItems')) || [];
        if (JSON.stringify(currentCart) !== JSON.stringify(cart.cart)) {
          cart.cart = currentCart;
          cart.loadCart();
          cart.updateSummary();
          console.log('Cart updated on visibility change');
        }
      }
    });

    // Function to add items to cart (can be called from medicines page)
    window.addToCart = function(medicine) {
      const existingItemIndex = cart.cart.findIndex(item => item.name === medicine.name);
      
      if (existingItemIndex > -1) {
        cart.cart[existingItemIndex].quantity = (cart.cart[existingItemIndex].quantity || 1) + 1;
      } else {
        cart.cart.push({
          ...medicine,
          quantity: 1,
          priceValue: parseFloat(medicine.price?.replace('₹', '') || medicine.priceValue || 0)
        });
      }
      
      cart.saveCart();
      cart.loadCart();
      cart.updateSummary();
      cart.showToast(`${medicine.name} added to cart!`, 'success');
    };

    // Function to get cart count (for cart badge on other pages)
    window.getCartCount = function() {
      const cartItems = JSON.parse(localStorage.getItem('cartItems')) || [];
      return cartItems.reduce((total, item) => total + (item.quantity || 1), 0);
    };

    // Function to clear cart
    window.clearCart = function() {
      cart.cart = [];
      cart.saveCart();
      cart.loadCart();
      cart.updateSummary();
    };

    // Initialize display addresses
    cart.displayAddresses = function() {
      const addressList = document.getElementById('addressList');
      if (!addressList) return;

      if (this.addresses.length === 0) {
        addressList.innerHTML = `
          <div class="text-center py-8">
            <i class="material-icons text-gray-400 text-4xl mb-2">location_off</i>
            <p class="text-gray-500">Using default delivery address</p>
          </div>
        `;
        return;
      }

      addressList.innerHTML = this.addresses.map(address => `
        <div class="modern-card p-4 cursor-pointer ${address.isDefault ? 'border-primary bg-primary/5' : ''}"
             onclick="cart.selectAddress(${address.id})">
          <div class="flex justify-between items-start mb-2">
            <h4 class="font-semibold">${address.fullName}</h4>
            ${address.isDefault ? '<span class="text-xs bg-primary text-white px-2 py-1 rounded">Default</span>' : ''}
          </div>
          <p class="text-sm text-gray-600 mb-1">${address.mobile}</p>
          <p class="text-sm text-gray-600 mb-1">${address.addressLine1}</p>
          ${address.addressLine2 ? `<p class="text-sm text-gray-600 mb-1">${address.addressLine2}</p>` : ''}
          <p class="text-sm text-gray-600">${address.city}, ${address.state} - ${address.pincode}</p>
        </div>
      `).join('');
    };

    cart.selectAddress = function(addressId) {
      this.addresses.forEach(address => {
        address.isDefault = address.id === addressId;
      });
      localStorage.setItem('addresses', JSON.stringify(this.addresses));
      this.displayAddresses();
      this.showToast('Delivery address selected', 'success');
    };

    // Initialize addresses display
    setTimeout(() => {
      cart.displayAddresses();
    }, 100);
  </script>
</body>
</html> 